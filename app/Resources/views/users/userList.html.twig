{% extends 'base.html.twig' %}

{% block title %}User list{% endblock %}

{% block javascripts %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="{{ asset('knppaginator-ajax/js/knppaginator-ajax.js') }}" type="text/javascript"></script>
    <script src="{{ asset('jquery-plugin-query-object/jquery.query-object.js') }}" type="text/javascript"></script>
    <script type="text/javascript" src="{{ asset('pagination/jquery.simplePagination.js') }}"></script>
    <link rel="stylesheet" type="text/css" href="{{ asset('pagination/simplePagination.css') }}">
    <script>
        $( document ).ready(function() {
            $.ajax({
                type: "POST",
                url: "{{ path('user_get') }}",
                data: {page: 1 },
                success: function (response) {
                    $('#response').html(response);
                }
            });
            $('div.response a').attr("href", "#");
            $(function() {
                $('#pag').pagination({
                    items: {{ pagination.getTotalItemCount }},
                    itemsOnPage: 10,
                    currentPage : currentPageNumber,
                    onPageClick : function(pageNumber){
                        getPage(pageNumber);
                        currentPageNumber = pageNumber;
                    }
                });
            });
        });
        function getPage(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('user_get') }}",
                data: {page: id , sort: sortMethod, direction:sortDirection},
                success: function (response) {
                    $('#response').html(response);
                }
            });
        }
        var currentPageNumber;
        var sortMethod;
        var sortDirection;
        function sortPage(url) {
            if(!currentPageNumber) currentPageNumber=1;
            url = url.replace("/user/get?", "");
            var qr = $.query.parseNew(url);
            qr = qr.set('page', currentPageNumber);
            sortMethod = qr.get('sort');
            sortDirection = qr.get('direction');
            url = qr.toString();
            url = url.replace("?", "");
            $.ajax({
                type: "POST",
                url: "{{ path('user_get') }}",
                data: url,
                success: function (response) {
                    $('#response').html(response);
                }
            });
        }
    </script>
{% endblock %}

{# total items count #}
{% block body %}
    <div class="container" id="pageContainer">
        <div class="row justify-content-center">
            <div class="col" id="response">

            </div>
        </div>
        <div class="row justify-content-center">
            <div id="pag">

            </div>
        </div>
    </div>



{% endblock %}